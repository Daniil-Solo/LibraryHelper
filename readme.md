# АРМ "Помощник библиотекаря"

## Функции
- создание, удаление, изменение книги;
- создание, удаление, изменение жанра;
- создание, удаление, изменение автора;
- создание, удаление, изменение пользователя;
- создание факта взятия/возвращения книги;
- указание параметров для подключения к БД;
- указание пути для отчетов и создание отчетов:
    - Сколько книг есть в библиотеке, сколько читателей;
    - Сколько книг брал каждый читатель за все время;
    - Сколько книг сейчас находится на руках у каждого читателя;
    - Дата последнего посещения читателем библиотеки;
    - Самый читаемый автор;
    - Самый предпочитаемые читателями жанры по убыванию;
    - Любимый жанр каждого читателя;
    - Пользователи и книги, которые не были возвращены вовремя.

## Технологии
- СУБД: PostgreSQL
- язык: Python
- графический интерфейс: PyQt5
- драйвер: psycopg2
- библиотека для работы с pdf: fpdf2

## Структура проекта
- database - скрипты для создания таблиц и загрузки данных, ER-модель
- source - основная директория с кодом приложения
  - fonts - шрифты Roboto для создания отчетов
  - page_controllers - обработчики для страниц приложения
  - reports - запросы для отчетов и создатель отчета
  - services - логика по обращению к БД
  - ui - интерфейс приложения
  - app.py - главный файл программы
  - config.py - работа с конфигом приложения
  - db.py - получение сессии БД

## Сборка приложения
### Переходим в директорию с кодом
```bash
cd source
```
### Устанавливаем библиотеки
```bash
pip install -r requirements.txt
```
### Первый вариант: Сборка в директорию с файлами
```bash
pyinstaller ./app.py --noconsole --icon=./ui/icon.ico --add-data ./fonts/;./fonts/
```
Результат сборки будет в директории dist/app. Файл для запуска: app.exe.

### Второй вариант: Сборка одним файлом
```bash
pyinstaller ./app.py --noconsole --onefile --icon=./ui/icon.ico --add-data ./fonts/;./fonts/
```
Результат сборки будет в директории dist. Файл для запуска: app.exe.

Для того чтобы работали отчеты во втором варианте, необходимо в директорию с app.exe поместить директорию fonts с шрифтами 

## Что можно доработать
- добавить стили для интерфейса
- проанализировать какие столбцы таблиц нуждаются в индексах
- ожидание ответа от БД делегировать другому потоку QThread
- использовать ORM, например, SQLAlchemy, вместо base-service и base-middle-service

## Демонстрация приложения
![](https://github.com/Daniil-Solo/LibraryHelper/blob/master/images/books.jpg "Работа с книгами")
![](https://github.com/Daniil-Solo/LibraryHelper/blob/master/images/connection.jpg "Подключение к базе данных")
![](https://github.com/Daniil-Solo/LibraryHelper/blob/master/images/fact.jpg "Создание факта выдачи/возвращения книги")
![](https://github.com/Daniil-Solo/LibraryHelper/blob/master/images/users.jpg "Работа с пользователем")
